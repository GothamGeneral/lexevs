<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL MAP 2.0//EN" 
	"http://www.ibatis.com/dtd/sql-map-2.dtd">
<sqlMap namespace="Association">
	
     <insert id="insertAssociationQualificationOrUsageContext" parameterClass="org.lexevs.dao.database.ibatis.association.parameter.InsertAssociationQualificationOrUsageContextBean">
		INSERT INTO $prefix$entityAssnQuals (
			entityAssnQualsGuid,
			referenceGuid,
			qualifierName,
			qualifierValue
		) VALUES (
			#uid#, 
			#associationTargetUId#,
			#qualifierName#, 
			#qualifierValue#
		)
  </insert>
  
  <delete id="deleteAssocQualsByCodingSchemeId" 
  	parameterClass="org.lexevs.dao.database.ibatis.parameter.PrefixedParameter">
  		DELETE FROM
  			$prefix$entityAssnQuals
  			
  		WHERE 
  			referenceGuid IN
  		( 
  		SELECT
  			eate.entityAssnsGuid
  			
  		FROM
  			$prefix$entityAssnsToEntity eate
	
  		LEFT JOIN
  			$prefix$associationPredicate ap
  		ON
  			ap.associationPredicateGuid =
  			eate.associationPredicateGuid
  			
  		LEFT JOIN
  			$prefix$relation rel
  		ON
  			ap.relationGuid =
  			rel.relationGuid
  			
  		WHERE
  			rel.codingSchemeGuid = #param1#
  
  		UNION
  		
  		SELECT
  			eatd.entityAssnsDataGuid
  			
  		FROM
  			$prefix$entityAssnsToData eatd
	
  		LEFT JOIN
  			$prefix$associationPredicate ap
  		ON
  			ap.associationPredicateGuid =
  			eatd.associationPredicateGuid
  			
  		LEFT JOIN
  			$prefix$relation rel
  		ON
  			ap.relationGuid =
  			rel.relationGuid
  			
  		WHERE
  			rel.codingSchemeGuid = #param1#
  		)
  </delete>
    
</sqlMap>